---
tags:
  - mod5
---
# ELK / EFK

ELK (Elasticsearch, Logstash, Kibana) –∏ –µ–≥–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ EFK (Fluentd –≤–º–µ—Å—Ç–æ Logstash) ‚Äî –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å—Ç–µ–∫–∏ –¥–ª—è —Å–±–æ—Ä–∞, –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–æ–≤. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ª–æ–≥–∏ —Å —Å–æ—Ç–µ–Ω —Å–µ—Ä–≤–∏—Å–æ–≤.
## üîë –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç–µ–∫–∞

### Elasticsearch
- –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –ø–æ–∏—Å–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ –±–∞–∑–µ Apache Lucene  
- –•—Ä–∞–Ω–∏—Ç –ª–æ–≥–∏ –∫–∞–∫ JSON-–¥–æ–∫—É–º–µ–Ω—Ç—ã  
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫, –∞–≥—Ä–µ–≥–∞—Ü–∏–∏, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ  
- –¢—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ RAM –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞
### Logstash (–≤ ELK) –∏–ª–∏ Fluentd (–≤ EFK)
- **Logstash** ‚Äî –º–æ—â–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –ª–æ–≥–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–æ–≤, –ø–∞—Ä—Å–∏–Ω–≥–∞, –æ–±–æ–≥–∞—â–µ–Ω–∏—è  
```ruby
  filter {
    grok { match => { "message" => "%{COMBINEDAPACHELOG}" } }
  }
```
- **Fluentd** ‚Äî –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π, –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Ruby, –ª—É—á—à–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å Kubernetes  

>‚Üí –ß–∞—â–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –æ–±–ª–∞—á–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö
> Fluentd –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –º–µ–Ω—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤, Logstash ‚Äî –≥–∏–±—á–µ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ.
### Kibana

- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–∏—Å–∫–∞, –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
- –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤, alert‚Äô–æ–≤, saved searches
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–∞—à–∏–Ω–Ω—ã–º –æ–±—É—á–µ–Ω–∏–µ–º (–∞–Ω–æ–º–∞–ª–∏–∏)
## üîÑ –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

1. **–°–±–æ—Ä**: –∞–≥–µ–Ω—Ç (Filebeat, Fluent Bit) —á–∏—Ç–∞–µ—Ç –ª–æ–≥–∏ —Å —Ö–æ—Å—Ç–∞
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞**: Logstash/Fluentd –ø–∞—Ä—Å–∏—Ç, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ—Ç –º–µ—Ç–∫–∏
3. **–•—Ä–∞–Ω–µ–Ω–∏–µ**: –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Elasticsearch
4. **–ê–Ω–∞–ª–∏–∑**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—â–µ—Ç –æ—à–∏–±–∫–∏, —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫–∏ –≤ Kibana

–ü—Ä–∏–º–µ—Ä:  
‚Üí –õ–æ–≥ –∏–∑ Nginx ‚Üí Filebeat ‚Üí Fluentd ‚Üí Elasticsearch ‚Üí Kibana-–¥–∞—à–±–æ—Ä–¥ ¬´HTTP Errors¬ª.
## ‚ö†Ô∏è –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

- ‚ùå ¬´–ò–Ω–¥–µ–∫—Å–∏—Ä—É—é –≤—Å—ë –ø–æ–¥—Ä—è–¥¬ª  
    ‚Üí –≠—Ç–æ –¥–æ—Ä–æ–≥–æ. –û—Ç–ø—Ä–∞–≤–ª—è–π —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è, –∏—Å–ø–æ–ª—å–∑—É–π `drop` –¥–ª—è —à—É–º–∞.
- ‚ùå ¬´–ù–µ—Ç —Ä–æ—Ç–∞—Ü–∏–∏ –∏–Ω–¥–µ–∫—Å–æ–≤¬ª  
    ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π ILM (Index Lifecycle Management): –≥–æ—Ä—è—á–∏–µ ‚Üí —Ç—ë–ø–ª—ã–µ ‚Üí —Ö–æ–ª–æ–¥–Ω—ã–µ ‚Üí —É–¥–∞–ª–µ–Ω–∏–µ.
- ‚ùå ¬´–•—Ä–∞–Ω—é –ª–æ–≥–∏ –±–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã¬ª  
    ‚Üí –í—Å–µ–≥–¥–∞ –ª–æ–≥–∏—Ä—É–π –≤ JSON ‚Äî —ç—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –∏ –ø–æ–∏—Å–∫.
## üí° –ì–ª–∞–≤–Ω–æ–µ

> ELK/EFK ‚Äî –º–æ—â–Ω—ã–π, –Ω–æ —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–∏–π —Å—Ç–µ–∫.  
> –î–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏ **Loki + Grafana** (–¥–µ—à–µ–≤–ª–µ, –ø—Ä–æ—â–µ).  
> –î–ª—è enterprise-—Å–∏—Å—Ç–µ–º ‚Äî ELK –æ—Å—Ç–∞—ë—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–µ-—Ñ–∞–∫—Ç–æ.

---
### –°–Ω–æ—à–∫–∏

[^filebeat]: Filebeat ‚Äî –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –∞–≥–µ–Ω—Ç –æ—Ç Elastic, —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ Logstash –Ω–∞ edge-–Ω–æ–¥–∞—Ö.