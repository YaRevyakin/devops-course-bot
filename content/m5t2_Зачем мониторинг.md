---
tags:
  - mod5
---
# –ó–∞—á–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥?

–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ‚Äî —ç—Ç–æ –Ω–µ ¬´–∫—Ä–∞—Å–∏–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏¬ª, –∞ **—Å–∏—Å—Ç–µ–º–∞ —Ä–∞–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞**. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –¥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏–∑–º–µ—Ä—è—Ç—å –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö.
## üîë –û—Ç –±–∏–∑–Ω–µ—Å-—Ü–µ–ª–µ–π –∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –º–µ—Ç—Ä–∏–∫–∞–º

### SLI ‚Üí SLO ‚Üí Alerting
- **SLI (Service Level Indicator)** ‚Äî –∏–∑–º–µ—Ä–∏–º–∞—è –º–µ—Ç—Ä–∏–∫–∞:  
  - –î–æ–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (`2xx / –≤—Å–µ–≥–æ`)  
  - Latency (p95 < 300ms)  
- **SLO (Service Level Objective)** ‚Äî —Ü–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ SLI:  
  - ¬´99.9% –∑–∞–ø—Ä–æ—Å–æ–≤ —É—Å–ø–µ—à–Ω—ã –∑–∞ 30 –¥–Ω–µ–π¬ª  
- **Error Budget** ‚Äî –¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–±–æ–µ–≤:  
  - –ï—Å–ª–∏ –∏—Å—á–µ—Ä–ø–∞–Ω ‚Üí –Ω–æ–≤—ã–µ —Ä–µ–ª–∏–∑—ã –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è  
- **–ê–ª–µ—Ä—Ç—ã** ‚Äî —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É–≥—Ä–æ–∑–µ SLO, –∞ –Ω–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏

> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑ SLO ‚Äî –ø—Ä–æ—Å—Ç–æ —à—É–º.

## üìä –°—Ç–µ–∫ Prometheus (–º–µ—Ç—Ä–∏–∫–∏)

- **Prometheus** ‚Äî —Å–æ–±–∏—Ä–∞–µ—Ç –∏ —Ö—Ä–∞–Ω–∏—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø–æ pull-–º–æ–¥–µ–ª–∏  
- **Grafana** ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: –¥–∞—à–±–æ—Ä–¥—ã, —Ç—Ä–µ–Ω–¥—ã, —Å—Ä–∞–≤–Ω–µ–Ω–∏—è  
- **Alertmanager** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞–º–∏: –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞, –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Slack/Telegram

–ü—Ä–∏–º–µ—Ä –º–µ—Ç—Ä–∏–∫–∏:
```promql
rate(http_requests_total{status=~"5.."}[5m]) / rate(http_requests_total[5m]) > 0.01
```
>‚Üí –ê–ª–µ—Ä—Ç, –µ—Å–ª–∏ >1% –æ—à–∏–±–æ–∫ –∑–∞ 5 –º–∏–Ω—É—Ç.
## üìù –°—Ç–µ–∫ Loki (–ª–æ–≥–∏)

- **Loki** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –±–µ–∑ –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ (–¥–µ—à–µ–≤–ª–µ Elasticsearch)
- **Promtail** ‚Äî –∞–≥–µ–Ω—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏–π –ª–æ–≥–∏ –≤ Loki
- **Grafana** ‚Äî –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –ª–æ–≥–æ–≤ + –º–µ—Ç—Ä–∏–∫

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:  
‚Üí –õ–æ–≥–∏ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —Ç–µ–º –∂–µ –º–µ—Ç–∫–∞–º (labels), —á—Ç–æ –∏ –º–µ—Ç—Ä–∏–∫–∏ ‚Üí –ª–µ–≥–∫–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞—Ç—å.
## ‚ö†Ô∏è –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

- ‚ùå ¬´–ê–ª–µ—Ä—Ç –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU > 80%¬ª  
    ‚Üí –≠—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ê–ª–µ—Ä—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ **–±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫—É** (–æ—à–∏–±–∫–∏, latency).
- ‚ùå ¬´–•—Ä–∞–Ω—é –≤—Å–µ –ª–æ–≥–∏ –≤–µ—á–Ω–æ¬ª  
    ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π —Ä–µ—Ç–µ–Ω—Ü–∏—é: –≥–æ—Ä—è—á–∏–µ ‚Äî 7 –¥–Ω–µ–π, —Ö–æ–ª–æ–¥–Ω—ã–µ ‚Äî 30, –∞—Ä—Ö–∏–≤ ‚Äî –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.
- ‚ùå ¬´–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ = —É—Å—Ç–∞–Ω–æ–≤–∏–ª Prometheus¬ª  
    ‚Üí –ù–∞—Å—Ç–æ—è—â–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è **—á—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**.
## üí° –ì–ª–∞–≤–Ω–æ–µ

> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Ç—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞:
> 
> 1. **–†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?** (SLO)
> 2. **–ü–æ—á–µ–º—É –æ–Ω–∞ —Å–ª–æ–º–∞–ª–∞—Å—å?** (–ª–æ–≥–∏ + —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏)
> 3. **–ö–∞–∫ —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å?** (–¥–∞—à–±–æ—Ä–¥—ã + –∞–ª–µ—Ä—Ç—ã)
> 
> –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –≤—Ç–æ—Ä–∏—á–Ω–æ.

---
### –°–Ω–æ—Å–∫–∏

[^pull-model]: Prometheus –∏—Å–ø–æ–ª—å–∑—É–µ—Ç pull-–º–æ–¥–µ–ª—å: —Å–∞–º –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã `/metrics`. –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ ¬´–º—ë—Ä—Ç–≤—ã—Ö¬ª —Å–µ—Ä–≤–∏—Å–æ–≤.