---
tags:
  - mod12
---
# ะัะพะตะบั: ะะฐัััะฐะฑะธััะตะผะฐั ะพะฑะปะฐัะฝะฐั ะธะฝััะฐััััะบัััะฐ

ะฆะตะปั ะฟัะพะตะบัะฐ โ ัะฐะทะฒะตัะฝััั ะพัะบะฐะทะพัััะพะนัะธะฒัั, ะผะฐัััะฐะฑะธััะตะผัั ะธะฝััะฐััััะบัััั ะฒ Yandex Cloud ั multi-AZ ัะฐะทะฒััััะฒะฐะฝะธะตะผ, ะฐะฒัะพะผะฐัะธัะตัะบะธะผ ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะตะผ ะธ ัะฟัะฐะฒะปัะตะผะพะน ะฑะฐะทะพะน ะดะฐะฝะฝัั.

## ๐ง ะญัะฐะฟั ะฒัะฟะพะปะฝะตะฝะธั

### 1. Multi-AZ ะฐััะธัะตะบัััะฐ

- ะกะพะทะดะฐะน **VPC** ั ะฟะพะดัะตััะผะธ ะฒ ะดะฒัั ะทะพะฝะฐั ะดะพัััะฟะฝะพััะธ:
  - `ru-central1-a` โ ะฟะพะดัะตัั `10.0.1.0/24`
  - `ru-central1-b` โ ะฟะพะดัะตัั `10.0.2.0/24`

- ะะฐะทะฒะตัะฝะธ **2 ะะ** (ะฟะพ ะพะดะฝะพะน ะฒ ะบะฐะถะดะพะน ะทะพะฝะต) ัะตัะตะท Terraform:
  ```hcl
  resource "yandex_compute_instance" "web" {
    for_each = toset(["a", "b"])
    zone     = "ru-central1-${each.key}"
    # ... ะพััะฐะปัะฝัะต ะฟะฐัะฐะผะตััั
  }
  ```
> ะญัะพ ะพะฑะตัะฟะตัะธะฒะฐะตั ะพัะบะฐะทะพัััะพะนัะธะฒะพััั ะฟัะธ ัะฑะพะต ัะตะปะพะน ะทะพะฝั.

---
### 2. Managed Database

- ะัะฟะพะปัะทัะน **Yandex Managed PostgreSQL**:
```hcl
resource "yandex_mdb_postgresql_cluster" "main" {
  environment = "PRODUCTION"
  network_id  = yandex_vpc_network.main.id

  config {
    version = 14
    resources {
      resource_preset_id = "s2.micro"
      disk_type_id       = "network-ssd"
      disk_size          = 10
    }
  }

  host {
    zone      = "ru-central1-a"
    subnet_id = yandex_vpc_subnet.private-a.id
  }
  host {
    zone      = "ru-central1-b"
    subnet_id = yandex_vpc_subnet.private-b.id
  }
}
```
- ะะ ัะฐะทะผะตัะตะฝะฐ ะฒ **ะฟัะธะฒะฐัะฝัั ะฟะพะดัะตััั**, ะฑะตะท ะฟัะฑะปะธัะฝะพะณะพ IP
- ะะบะปััะตะฝะฐ **ะฐะฒัะพะผะฐัะธัะตัะบะฐั ัะตะฟะปะธะบะฐัะธั** ะผะตะถะดั ะทะพะฝะฐะผะธ
---
### 3. Application Load Balancer

- ะะฐัััะพะน **Application Load Balancer** (L7):
```hcl
resource "yandex_alb_load_balancer" "main" {
  name = "web-lb"

  network_id = yandex_vpc_network.main.id

  allocation_policy {
    location {
      zone_id = "ru-central1-a"
    }
    location {
      zone_id = "ru-central1-b"
    }
  }

  listener {
    name = "http-listener"
    endpoint {
      address {
        external_ipv4_address {}
      }
      ports = [80]
    }
  }
}
```
- ะะพะฑะฐะฒั **health check** ะฝะฐ `/healthz`
- ะัะธะฒัะถะธ ะพะฑะต ะะ ะบะฐะบ ะฑัะบะตะฝะดั
---
### 4. ะะฒัะพะผะฐัะธัะตัะบะพะต ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะต

- ะัะฟะพะปัะทัะน **Instance Groups** (managed instance group):
```hcl
resource "yandex_compute_instance_group" "web" {
  name = "web-group"

  instance_template {
    platform_id = "standard-v3"
    resources { cores = 2; memory = 2 }
    boot_disk { initialize_params { image_id = var.web_image } }
    network_interface { subnet_ids = [yandex_vpc_subnet.public-a.id, yandex_vpc_subnet.public-b.id] }
  }

  scale_policy {
    auto_scale {
      initial_size = 2
      measurement_duration = 60
      cpu_utilization_target = 70
      min_zone_size = 1
      max_size = 10
    }
  }
}
```
- ะััะฟะฟะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ:
    - ะะพะดะดะตัะถะธะฒะฐะตั ะผะธะฝะธะผัะผ 2 ะะ (ะฟะพ ะพะดะฝะพะน ะฒ ะทะพะฝะต)
    - ะะฐัััะฐะฑะธััะตััั ะฟัะธ ะฝะฐะณััะทะบะต >70% CPU
    - ะะฐะผะตะฝัะตั ยซะฑะธััะตยป ะะ
---
### 5. ะะตะทะพะฟะฐัะฝะพััั ะธ ะผะพะฝะธัะพัะธะฝะณ

- **Security Groups**:
    - ะัะพะด: ัะพะปัะบะพ 80/443
    - ะััะพะด: ะฒัั ัะฐะทัะตัะตะฝะพ
    - ะะ: ัะพะปัะบะพ ะธะท ะฟะพะดัะตัะธ ะฟัะธะปะพะถะตะฝะธะน
- **ะะพะฝะธัะพัะธะฝะณ**:
    - ะะบะปััะธ Yandex Monitoring ะดะปั ะะ ะธ ะะ
    - ะะฐัััะพะน ะฐะปะตััั ะฝะฐ CPU, ะดะธัะบ, replication lag
- **ะัะบะฐะฟั**:
    - Managed PostgreSQL ะดะตะปะฐะตั ะฐะฒัะพะผะฐัะธัะตัะบะธะต ะฑัะบะฐะฟั
    - ะะฐัััะพะน ััะฐะฝะตะฝะธะต ะฝะฐ 7 ะดะฝะตะน

---

## ๐ก ะะพัะตะผั ััะพ ะฒะฐะถะฝะพ?

> ะญัะพั ะฟัะพะตะบั ะดะตะผะพะฝัััะธััะตั **production-ready ะฐััะธัะตะบัััั**:
> 
> - **ะัะบะฐะทะพัััะพะนัะธะฒะพััั** (multi-AZ)
> - **ะะฐัััะฐะฑะธััะตะผะพััั** (instance groups)
> - **ะะตะทะพะฟะฐัะฝะพััั** (ะฟัะธะฒะฐัะฝะฐั ัะตัั, managed DB)
> - **ะะฐะฑะปัะดะฐะตะผะพััั** (ะฒัััะพะตะฝะฝัะน ะผะพะฝะธัะพัะธะฝะณ)

ะขะฐะบะฐั ะธะฝััะฐััััะบัััะฐ ะฒัะดะตัะถะธะฒะฐะตั ัะฑะพะธ ะทะพะฝ, ะฒัะฟะปะตัะบะธ ะฝะฐะณััะทะบะธ ะธ ะทะฐัะธัะฐะตั ะดะฐะฝะฝัะต.

---
## ๐๏ธ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ
```
cloud-scalable/
โโโ terraform/
โ   โโโ main.tf          # VPC, subnets
โ   โโโ vms.tf           # Instance Group
โ   โโโ db.tf            # Managed PostgreSQL
โ   โโโ lb.tf            # Application Load Balancer
โ   โโโ variables.tf
โโโ README.md            # ะะฐะบ ัะฐะทะฒะตัะฝััั
```
