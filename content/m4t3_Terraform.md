---
tags:
  - mod4
---
# Terraform

Terraform ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç **–¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π**, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π HashiCorp. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –æ–±–ª–∞—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (–∏ –Ω–µ —Ç–æ–ª—å–∫–æ) —Å –ø–æ–º–æ—â—å—é –∫–æ–¥–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å, –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.
## üîë –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. **–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã**
Terraform –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–æ—Ç–Ω–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º —á–µ—Ä–µ–∑ **–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã**:
- `aws` ‚Äî Amazon Web Services  
- `yandex` ‚Äî Yandex Cloud  
- `google` ‚Äî Google Cloud Platform  
- `kubernetes` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ  
- `docker` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

–ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
```hcl
provider "yandex" {
  token     = var.yc_token
  cloud_id  = var.yc_cloud_id
  folder_id = var.yc_folder_id
  zone      = "ru-central1-a"
}
```
### 2. **–†–µ—Å—É—Ä—Å—ã**

–û–ø–∏—Å—ã–≤–∞—é—Ç –∂–µ–ª–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
```hcl
resource "yandex_compute_instance" "vm-1" {
  name = "my-vm"
  platform_id = "standard-v3"
  zone = "ru-central1-a"

  resources {
    cores  = 2
    memory = 2
  }

  boot_disk {
    initialize_params {
      image_id = "fd8ivq60g5vns9l8d87m"
    }
  }

  network_interface {
    subnet_id = yandex_vpc_subnet.subnet-1.id
    nat       = true
  }
}
```
### 3. **State-—Ñ–∞–π–ª (`terraform.tfstate`)**

- –•—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –µ–≥–æ —Å –∫–æ–¥–æ–º ‚Üí –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å
- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é!**
- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ **—É–¥–∞–ª—ë–Ω–Ω–æ–º –±—ç–∫–µ–Ω–¥–µ** (S3, Yandex Object Storage)

### 4. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –≤—ã–≤–æ–¥—ã**
```hcl
variable "instance_count" {
  description = "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –í–ú"
  type        = number
  default     = 2
}

output "vm_ips" {
  value = yandex_compute_instance.vm-1.*.network_interface.0.nat_ip_address
}
```
## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª Terraform

1. **`terraform init`** ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤)
2. **`terraform plan`** ‚Äî –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. **`terraform apply`** ‚Äî –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
4. **`terraform destroy`** ‚Äî –ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

> –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ã: –ø–æ–≤—Ç–æ—Ä–Ω—ã–π `apply` –Ω–∏—á–µ–≥–æ –Ω–µ —Å–ª–æ–º–∞–µ—Ç.
## ‚ö†Ô∏è –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

- ‚ùå ¬´–•—Ä–∞–Ω—é `tfstate` –ª–æ–∫–∞–ª—å–Ω–æ¬ª  
    ‚Üí –í –∫–æ–º–∞–Ω–¥–µ —ç—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º. –ò—Å–ø–æ–ª—å–∑—É–π —É–¥–∞–ª—ë–Ω–Ω—ã–π –±—ç–∫–µ–Ω–¥.
- ‚ùå ¬´–ò–∑–º–µ–Ω—è—é —Ä–µ—Å—É—Ä—Å—ã –≤ –æ–±–ª–∞–∫–µ –≤—Ä—É—á–Ω—É—é¬ª  
    ‚Üí Terraform –Ω–µ —É–∑–Ω–∞–µ—Ç –æ–± —ç—Ç–æ–º ‚Üí –¥—Ä–µ–π—Ñ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
- ‚ùå ¬´–ö–æ–º–º–∏—á—É —Å–µ–∫—Ä–µ—Ç—ã –≤ Git¬ª  
    ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π `variables` + `.tfvars` (–¥–æ–±–∞–≤—å –≤ `.gitignore`) –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (Vault, SSM).
## üí° –ì–ª–∞–≤–Ω–æ–µ

> Terraform ‚Äî —ç—Ç–æ **–µ–¥–∏–Ω—ã–π —è–∑—ã–∫ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ª—é–±–æ–≥–æ –æ–±–ª–∞–∫–∞**.  
> –û–Ω –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Ä—É—á–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫ –≤ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π, —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã–π –∏ –∞—É–¥–∏—Ä—É–µ–º—ã–π –ø—Ä–æ—Ü–µ—Å—Å.

---
### –°–Ω–æ—Å–∫–∏

[^hcl]: HCL (HashiCorp Configuration Language) ‚Äî –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π —è–∑—ã–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π Terraform. –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º, –Ω–æ —Å—Ç—Ä–æ–≥–∏–π.